# This file is automatically generated by SnowBlower.
# Do not edit this file directly as your changes will be overwritten.
# Instead, modify your flake.nix configuration to update Docker services.

x-snowblower-common: &snowblower-common
  build:
    args:
      USER_GID: ${SB_USER_GID}
      USER_UID: ${SB_USER_UID}
    context: .
    dockerfile: ./docker/Dockerfile
  depends_on:
  - redis
  environment:
    SB_SESS_IS_NIX_SHELL: '1'
    USER_GID: ${SB_USER_GID}
  tty: true
  volumes:
  - .:/workspace
  working_dir: /workspace
services:
  npm-dev:
    <<: *snowblower-common
    command: ./snow npm-dev
    ports:
    - 5432:5432
  redis:
    healthcheck:
      interval: 10s
      retries: 3
      test:
      - CMD
      - redis-cli
      - ping
      timeout: 5s
    image: redis:alpine
    ports:
    - 6379:6379
    restart: unless-stopped
    volumes:
    - ${SB_PROJECT_STATE}/redis:/data
  snowblower-dev:
    <<: *snowblower-common
